@startuml
!include style.puml
skinparam ArrowFontStyle plain

box Logic LOGIC_COLOR_T1
participant ":LogicManager" as LogicManager LOGIC_COLOR
participant ":AddressBookParser" as AddressBookParser LOGIC_COLOR
participant ":DeleteClassCommandParser" as DelParser LOGIC_COLOR
participant "dc:DeleteClassCommand" as DelCmd LOGIC_COLOR
participant "r:CommandResult" as CommandResult LOGIC_COLOR
end box

box Model MODEL_COLOR_T1
participant "m:Model" as Model MODEL_COLOR
participant "c:TuitionClass" as Class MODEL_COLOR
end box

[-> LogicManager : execute("deleteclass c/Sec2-Math-A")
activate LogicManager
LogicManager -> AddressBookParser : parseCommand(...)
activate AddressBookParser
create DelParser
AddressBookParser -> DelParser
activate DelParser
DelParser --> AddressBookParser
deactivate DelParser

AddressBookParser -> DelParser : parse("c/Sec2-Math-A")
activate DelParser
DelParser -> DelParser : validate prefix c/
create DelCmd
DelParser -> DelCmd
activate DelCmd
DelParser --> AddressBookParser : dc
deactivate DelParser
deactivate AddressBookParser

LogicManager -> DelCmd : execute(m)
activate DelCmd

DelCmd -> Model : getClassByName("Sec2-Math-A")
activate Model
Model --> DelCmd : c
deactivate Model

note right of DelCmd
  Cascade cleanup:
  Remove all students,
  unassign tutors,
  clear sessions
end note

DelCmd -> Class : removeAllStudents()
activate Class
Class --> DelCmd
deactivate Class

DelCmd -> Class : unassignAllTutors()
activate Class
Class --> DelCmd
deactivate Class

DelCmd -> Class : clearSessions()
activate Class
Class --> DelCmd
deactivate Class

DelCmd -> Model : deleteClass(c) & save
activate Model
Model --> DelCmd
deactivate Model

create CommandResult
DelCmd -> CommandResult
DelCmd --> LogicManager : r
deactivate DelCmd
[<-- LogicManager
deactivate LogicManager

note right of DelCmd
  Errors:
  - Class not found
end note
@enduml
